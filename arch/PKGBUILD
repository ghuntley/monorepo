# Maintainer: Vincent Ambo <dev@tazj.in>
pkgname=tazblog
pkgver=4.1
pkgrel=2
pkgdesc="Tazjin's blog written in Haskell"
arch=('i686' 'x86_64')
url="http://tazj.in"
license=('MIT')
makedepends=('ghc' 'cabal-install')
source=(https://bitbucket.org/tazjin/tazblog-haskell/get/$pkgver.tar.gz)
md5sums=('981cdfdd3cba59f13213a644717f5343')


build() {
  cd "$srcdir"
  cd tazjin-*

  cabal update
  cabal sandbox init
  cabal install -j --only-dependencies
  cabal build
}

package() {
  cd "$srcdir"
  cd tazjin-*

  # Install blog itself
  install -d "${pkgdir}/usr/bin"
  install -m755 dist/build/tazblog/tazblog "${pkgdir}/usr/bin/tazblog"

  # Install resources
  install -d "${pkgdir}/usr/share/tazblog"
  cp -r res/ "${pkgdir}/usr/share/tazblog"

  # Install service file
  install -d "${pkgdir}/usr/lib/systemd/system"
  cp "arch/tazblog@.service" "${pkgdir}/usr/lib/systemd/system/"
}
